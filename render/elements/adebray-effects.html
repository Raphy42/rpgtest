<link rel=import href="../bower_components/paper-icon-button/paper-icon-button.html">

<dom-module id="adebray-effects">
	<template>
		<style>
			:host {
				display: block;
			}
		</style>

	<div class=centered>
		<div id='container'></div>
	</div>

	<template is="dom-if" if="{{isOn(state)}}">
		<paper-icon-button icon="mdi:pause" on-tap="toggleStop"></paper-icon-button>
	</template>
	<template is="dom-if" if="{{isOff(state)}}">
		<paper-icon-button icon="mdi:play" on-tap="toggleStart"></paper-icon-button>
	</template>
	</template>

	<script>
		Polymer({
			is: 'adebray-effects',

			properties: {
				state: {
					type: String,
					value: false
				}
			},

			isOn: function (mode) {
				return mode === true
			},

			isOff: function (mode) {
				return mode === false
			},

			toggleStop: function () {
				this.anim.stop()
				this.state = false
			},

			toggleStart: function () {
				this.anim.start()
				this.state = true
			},

			attached: function () {
				var stage = new Konva.Stage({
					container : this.$$('#container'),
					width: 400,
					height: 400
				})
				layer = new Konva.Layer()

				stage.add(layer)

				var hexagon = new Konva.RegularPolygon({
					x: 200,
					y: 208,
					sides: 6,
					radius: 48,
					// fill: 'red',
					stroke: 'black',
					strokeWidth: 4
				})

				var imageObj = new Image();
				imageObj.onload = () => {
					// console.log(imageObj)
					var image = new Konva.Image({
						x: 200 - imageObj.width / 2,
						y: 200 - imageObj.height / 2,
						image: imageObj,
						width: imageObj.width,
						height: imageObj.height
					});

					// console.log(hexagon.getTransform())

					// hexagon.scaleY(0.3)
					layer.add(hexagon)
					layer.add(image)
					layer.draw()


					this.anim = new Konva.Animation(function(frame) {
					    var scale = Math.sin(frame.time * 2 * Math.PI / 2000) + 0.001;
					    // hexagon.scaleX(Math.cos(frame.time * 2 * Math.PI / 2000) + 0.001);
					    hexagon.rotate(1)
					    hexagon.scaleY(Math.sin(frame.time * 2 * Math.PI / 2000) + 0.001);
					}, layer);


				};
				imageObj.src = localStorage.getItem('/Users/adebray/rpgtest/render/images2/combat_dummy/test/6')

			}

		});
	</script>
</dom-module>
