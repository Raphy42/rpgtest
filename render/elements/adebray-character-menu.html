<link rel=import href="../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel=import href="../bower_components/paper-listbox/paper-listbox.html">

<dom-module id="adebray-character-menu">
	<template>
		<style>
			:host {
				display: block;
				padding: 8px;
				margin: 4px;
			}
		</style>

		<paper-dropdown-menu label="Job">
		  <paper-listbox id="joblist" class="dropdown-content" selected={{getJobI(character)}} on-iron-select=changeJob>
		    <template is="dom-repeat" items={{getJobList(jobs)}}>
			    <paper-item>{{item}}</paper-item>
			</template>
		  </paper-listbox>
		</paper-dropdown-menu>

		<iron-image src={{getFaceImage(character)}}></iron-image>

	</template>
	<script>
		Polymer({
			is: 'adebray-character-menu',

			properties: {
				character: Object,
				jobs: {
					type: Object,
					value: jobs
				}
			},

			getFaceImage: function (c) {
				return c.character.attrs.images[0].src
			},

			getJobI: function (c) {
				let i = undefined
				Object.keys(jobs).forEach( (k, _i) => {
					if (k == c.attrs.job.name)
						i = _i
				})
				return i
			},

			getJobList: function (jobs) {
				return Object.keys(jobs)
			},

			changeJob: function (e) {
				let i = undefined
				Object.keys(jobs).forEach( (k, _i) => {
					if (_i == e.target.selected)
						i = k
				})
				this.character.attrs.job = jobs[i]
			},

			fill: function () {
				new Character({
					position: 6,
					image: 'images2/combat_dummy/BODY_animation.png',
					class: 'Freelancer',
					body: items.Vest,
					left: items.Knife,
					callback: (c) => this.set('character', c)
				})
			},

			attached: function () {
				this.fill()
			}
		});
	</script>
</dom-module>
